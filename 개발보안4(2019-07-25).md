개발보안4(2019-07-25)



<u>웹에서 가장중요한것은 세션 셔션이 유출되면 그 사람인것 처럼 세션을 속일 수 있다 그래서 세션을 잘 만들고 잘 관리되어야 한다.</u>





쿠키:요청과요청간의 관계를 이어주기위한 개념 서버가 클라이언트에게 부여하는 값

브라우저는 사용자의 관여 없이 

- 서버가 웹브라우저로 전송하는 작은 텍스트 정보 파일

- 한번저장된 쿠키는 유효기간이 경과하지 않았다면 해당 도메인에 접속하면 브라우저가 자동으로 탑재하여 전송

- 웹서버는 set-cookie 헤더를 통해 생성한 쿠키를 클라이언트에게 전송

- 웹브라우저는 cookie 요청 헤더에 쿠키를 더해서 웹서버에게 요청

 

쿠키의 유효기간(년월일시분초), 지속시간(개봉후 3개월간 유효 합니다. maxage로 표현)

보안속성: Secure 브라우저로 올라간 서버는 무조건 서버로 올라가는것이 아니라 http통신 할때만

httponly :이 속성이 설정되면 쿠키는 클라이언트의 자바스크립트로 직접 접근할 수 없음)모든 브라우저가 지원하지 않음)  



디스크쿠키:영속

메인:비연속



webstorage



세션

-웹 서버가 해당 웹 서버에 접근한(요청한) 클라이언트(사용자)를 식별하는 방법

server side 기술로 http의 stateless 한 특성을 보완하기위하여, 유일한 세션 아이디를 생성하여 현재 접속한 클라이언트에게 할당해주고 기억하는 방식

웹 서버 또는 웹 어플리케이션 서버에서 세션 핸들링서비스를 지원



키 도난 방지 

-----------------------------------------------------------------------------------------------------------------------------------

<strong>인코딩 스키마</strong>

문자인코딩

- 문자들의 집합을 컴퓨터에서 저장하거나 통신에 사용할 목적으로 부호화하는 방법을 가리키며, 그냥 인코딩이라고도 불린다.
- 웹 애플리케이션에서 사용되는 데이터들도 네트워크를 통해 여러종류의 시스템으로 전달되는 환경이므로 여러가지 인코딩 스키마를 적용하여 데이터를 안전하게 사용하도록 조치한다.



ASCII -정보를 표현하는데 기본이되는것

눈에보이는거(출력 가능한 문자) 95 기계한테 명령내리는거(출력 불가능한 제어문자) 33



제어문자와 특수문자는 별도의 이름을 가지고있다.

--------------------------------------------------------------------------------------------------------------------------------------

<strong>URL 인코딩</strong>

URL - 요청할때 서버가 가지고있는 자원의 위치

내가원하는 파일을 유니크하게 표현할 수 있는 방법

파일이 저장되어있는 서버를 구분할 수 있고 그 아래에서는 디렉토리 체계로 가져가고있다.

저장되어있는 서버와 그 서버의 경로를 통해서 어떤 자원을 표현하면 전세계에 있는 모든 자원을 유니크하게 표현할 수 있다.

브라우저에서 만든 데이터를 서버에 그대로 전달하는것



<strong>HTML Encoding</strong>

- 문제가 있을만한 문자들을 html 문서 컨텐츠의 일부분으로 안전하게 사용하기 위해 서용
- HTML 문서 안에서 특별한 의미를 지니고, 문서의 구성 보다는 내용을 정의 하는데 사용
- HTML 엔티티 정의에 사용
- 10진법, 16진법 등으로 표현 가능

- 알파벳과 숫자는 이름이 없다. 눈에 보이지않는 제어문자와 특수문자만 이름을 가지고 있다.

- 서버에서 만든 데이터를 그대로 내려보내려고 쓴다.

- 스크립트 코드 실행되지 않음    
- 내가 받는 응답문서에 &시작하는 문자가 나오면 자동으로 브라우저에서 디코딩함



-----------------------------------------------------------------------------------------------------------------------------------------------------

<strong>Base64인코딩</strong>

- 64개의 데이터를 표현한다. 6비트로 표현하는것 0부터 63 까지

- 어떤 시스템이 텍스트 데이터밖에 못써서 내가가지고있는 바이너리데이터를 텍스트화하기위해서 사용

- 바이너리영역의 데이터를 가시영역의 문자로 바꿔서가시화시키는것

- 메일보낼때 문서(바이너리)를 보내고싶을때 Base64 인코딩을 이용하여 텍스트 형태로 바꾸어서 보낸다

- 그렇게 하면 사람이 시각적으로 비교할 수 있음





--------------------------------------------------------------------------------------------------------------------------------------------------------------

<strong>정규식</strong> 

 문자열의 검색 ,치환 ,추출을 위해 사용되는 패턴

<u>내가 원하는 형태의 데이터를 표현하고자 하는 방법</u>



-----------------------------------------------------------------------------------------------------------------------------------------------------------------

보안취약점 제거를 위한 코딩 기법

규범화 -일반화된 형식으로 압축하는것 데이터 손실 없이 입력 데이터를 가장 간단하면서 대등한 형태로 축소하는 과정

정규화- 데이터 손실은 있지만 알려진 가장 간단한 형태로 변환하는 과정

//데이터 함축화

입력값 새니타이즈 - 데이터를 받은 서브시스템의 요구사항에 맞게 데이터를 가공하는 과정

//데이터 가공

그다음 비교를 해줘야 정확한 검증이 된다.



SQL 삽입

웹 어플리케이션에서 입력 받아 데이터베이스로 전달하는 정상적인 쿼리를 변조, 삽입하여 데이터베이스에 불법적인 데이터 열람, 시스템 명령 수행 등 비정상적인 데이터베이스에 접근하는 기법이다. 모든 종류의 DBMS에 적용 가능한 공격 기법이며, 지속적으로 발전되고 있는 공격 기법이다.



어떤 입력값을 쿼리를 만드는데 사용하고 입력값에 쿼리조작 문자열이 포함되면 쿼리의 형태가 바뀌고 바껴서 실행된다. 그래서 비정상적인 데이터베이스에 접근할 수 있다.



피해

- DB정보 열람 및 추가 수정 삭제

- 프로시저(반복 작업하는 것을 함수형태로 만들어놓고 DB에 저장)를 통한 운영체제 명령어 수행

  SP(Stored Procedure) -데이터 베이스에 어떤 반복적인 업무를 함수로 만들어놓고 DB에 등록을 하면 등록된것을 호출하여 사용할수있음 (sql문 새로 짤필요 없이)

  사용자가만드는 객체 시스템이 만드는 객체 내가 만드는 테이블이있고 원래 존재하는 테이블이 있다.

  내가 필요에따라 만드는 sp가 있고 데이타 베이스 깔면 기본적으로 만들어져있는 sp가 있다.

  내가 만든것은 일반적으로 내가 수행하는 업무에 관련.

  시스템 프로시저는 시스템 관리목적에 관한 것들이 많음.

  해당하는 db가 설치되어있는 시스템의 쉘명령어수행 

  의도하지 않은 불특정 공격자를 통해서 이루어짐



search.jsp

-----------------------------------------------------------------

외부입력값을 검증없이 sql을 만드는 값으로 사용함 

​	코드 String  ptext = request.getParameter("text");

​			 String query = "select * from data where keyword = ' " +ptext + '' ' ";

​	 		Statement stmt = connection.createStatement(); 

​			 stmt.executeQuery(query);

​			sql 명령문을 전달하는 객체 statement

정상적인 요청 -> search.jsp?text=abcd

select * from data where keyword = 'abcd'



비정상적인 요청  유형 -> SQL Injection 공격 유형 다섯가지

#1 항상 참이 되는 입력 -> 모든 내용이 반환 = 권한 밖의 데이터에 대해 접근이 가능해진다.

  search.jsp?text=abcd' or 'a' = 'a

  select * from data where keyword =' abcd' or 'a' = 'a'

= data 테이블에 모든 데이터를 조회해서 반환

- 웹 어플리케이션을 조정해 다른 시스템 공격
- 외부 프로그램 사용
- 불법 로그인



#2  오류를 유발하는 입력 -> 추가 공격을 위한 정보수집을 하기 위해서 일부러 오류가 날 수 있는 값들을 집어넣는다.....  홑따옴표가 대표적으로 오류를 낼 수 있는 문자. 

  search.jsp?text=abcd' 

 select * from data where keyword ='abcd' ' 

홑따옴표의 개수가 일치하지 않아서 오류가 발생 -> 오류 메시지에 대한 처리가 불완전하여 시스템 내부 정보가 사용자 화면에 출력될 수 있음 공격자는 그 정보를 가지고 추가적인 공격을 시도 한다.

